(window["webpackOVP2"]=window["webpackOVP2"]||[]).push([["configurator-screen~entry-screen"],{"02b4":function(t,e,n){},"1838e":function(t,e,n){},1959:function(t,e,n){},"21ce":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"persons"}},[t.busy?n("sanitas-loading"):[n("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"section"},[n("div",{staticClass:"section_content"},[n("div",{staticClass:"form form--600width"},[n("div",{staticClass:"inline"},[n("sanitas-zip-chooser",{staticClass:"location-field",attrs:{required:"",title:t.label("zip_chooser_label"),placeholder:t.label("zip_chooser_placeholder"),autofocus:!t.hasLocation,tooltip:t.label("location_tooltip"),errors:t.getErrors(t.$v.location),label:t.label,"data-function":t.getLocation,"info-message-no-result":t.label("zip_chooser_noResuts"),"info-message-backend-error":t.label("general_error")},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}})],1),n("div",{staticClass:"inline inline--one-third"},[n("div",{staticClass:"input-modal-container"},[n("sanitas-date-input",{attrs:{required:"",lazy:"",name:"vertragsbeginn","data-test":"persons_contractStartDate",min:t.minContractStartDate,max:t.maxContractStartDate,mask:"##.##.####",placeholder:t.label("date_placeholder"),title:t.label("vertragsbeginn"),label:t.label,errors:t.getErrors(t.$v.contractStartDate)},on:{blur:function(e){return t.$v.contractStartDate.$touch()}},model:{value:t.contractStartDate,callback:function(e){t.contractStartDate=e},expression:"contractStartDate"}}),n("sanitas-icon",{attrs:{name:"information",color:"original-green",size:18},on:{click:function(e){t.showVertragsbeginnModal=!0}}})],1),t.showVertragsbeginnModal?n("sanitas-modal",{attrs:{"close-icon":""},on:{close:function(e){t.showVertragsbeginnModal=!1}}},[n("tooltip-contract-date")],1):t._e()],1),t.isCollective?n("div",{staticClass:"inline"},[n("div",{staticClass:"input-modal-container"},[n("sanitas-radio-group",{attrs:{horizontal:"","data-test":"persons_isCollective",title:t.label("collective_toggle_label"),items:t.collectiveToggleItems},model:{value:t.isCollective,callback:function(e){t.isCollective=e},expression:"isCollective"}}),n("sanitas-icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.label("collective_tooltip"),expression:"label('collective_tooltip')"}],staticClass:"collective_info_icon",attrs:{tabindex:"-1",name:"information",color:"original-green",size:18}})],1)]):t._e()]),t.showCollectiveForm?n("div",{staticClass:"form form--collective"},[n("div",{staticClass:"inline"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isCollective,expression:"isCollective"}],staticClass:"input-modal-container"},[n("sanitas-text-input",{attrs:{"data-test":"persons_collectivePartnerId",required:"",title:t.label("collective_partners_dropdown_label"),maxLength:7,errors:t.getErrors(t.$v.collectivePartnerId)},on:{blur:function(e){return t.$v.collectivePartnerId.$touch()}},model:{value:t.collectivePartnerId,callback:function(e){t.collectivePartnerId=e},expression:"collectivePartnerId"}}),n("sanitas-icon",{attrs:{name:"information",color:"original-green",size:18},on:{click:function(e){t.showCollectiveIdModal=!0}}}),t.showCollectiveIdModal?n("sanitas-modal",{attrs:{"close-icon":"",name:"collectiveIdModal"},on:{close:function(e){t.showCollectiveIdModal=!1}}},[n("modal-content",[n("div",{domProps:{innerHTML:t._s(t.label("collectiveId_tooltip"))}})])],1):t._e()],1)])]):t._e()])]),n("div",{staticClass:"section"},[n("transition-group",{attrs:{name:"personList",tag:"div"}},[t._l(t.$v.people.$each.$iter,(function(e,r){return[n("div",{key:e.$model.id,staticClass:"person",class:{person:!0,"person--entry":"Entry"===t.source}},[n("ovp-person",{key:e.$model.id,attrs:{validation:e,"validation-errors-getter":t.getErrors,person:e.$model,autofocus:t.hasLocation,deletable:r>0,"person-groups":t.collectivePersonGroups},on:{save:t.submit,delete:function(e){return t.deletePerson(r)}}})],1)]}))],2),n("div",{staticClass:"section_actions"},[n("div",{staticClass:"section_left"},[n("sanitas-button",{staticClass:"secondary",attrs:{secondary:"","data-test":"persons_addButton",disabled:!t.isPersonsAddEnabled()},on:{click:t.addPerson}},[t._v("\n              "+t._s(t.label("person_add"))+"\n            ")])],1),n("div",{staticClass:"section_right"},[t.cancelable?n("sanitas-button",{staticClass:"secondary",attrs:{type:"button",secondary:"","data-test":"persons_cancelButton"},on:{click:function(e){return t.$emit("cancel")}}},[t._v("\n              "+t._s(t.label("cancel_button_text"))+"\n            ")]):t._e(),n("sanitas-button",{staticClass:"primary",attrs:{type:"submit","data-test":"calculate_premium_button",primary:""}},[t._v("\n              "+t._s(t.label("calculate_premium"))+"\n            ")])],1)])],1)]),t.hasMessages?n("div",{staticClass:"person-messages"},[t.onlyBabyPersons?n("sanitas-message",{attrs:{severity:"warning",icon:"help",text:t.label("persons_unborn_text")}}):t._e(),t.contractStartDateUpdated?n("sanitas-message",{attrs:{severity:"warning",icon:"help",text:t.label("persons_contractStartDate_text")}}):t._e(),n("sanitas-message",{directives:[{name:"show",rawName:"v-show",value:t.hasNameChanged,expression:"hasNameChanged"}]},[t._v("\n        "+t._s(t.label("persons_data_name_changed"))+"\n      ")])],1):t._e()]],2)},a=[],o=n("2ef0"),i=n("2f62"),s=n("b166"),c=n("a618"),l=n("74b5"),u=n("e3ee"),d=n("1d9b"),p=n("7677"),h=n("ba1e"),v=n("1212"),b=n("de76"),f=n("db6d"),m=n("a01a"),g=n("2fac"),C=n("be1f"),O=n("5e3e"),P=n("b5ae"),y=n("1d42"),_=n("5af1"),j=n("52db"),w=n("8644"),S=n("3beb"),D=n("4461"),I=n("f121");function E(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,a)}function N(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){E(o,r,a,i,s,"next",t)}function s(t){E(o,r,a,i,s,"throw",t)}i(void 0)}))}}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){R(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $={name:"Persons",mixins:[C["a"]],components:{ModalContent:m["a"],OvpPerson:f["a"],SanitasButton:b["a"],SanitasDateInput:b["d"],SanitasIcon:b["f"],SanitasLoading:b["k"],SanitasMessage:b["g"],SanitasModal:b["l"],SanitasRadioGroup:b["j"],SanitasTextInput:b["n"],SanitasZipChooser:b["m"],TooltipContractDate:g["a"]},props:{source:String,cancelable:{type:Boolean,default:!1},linkToCollectiveContract:{type:String,default:""}},data:function(){return{contractStartDate:null,isCollective:!1,collectivePartnerId:null,location:{},people:[],submitTried:!1,onlyBabyPersons:!1,contractStartDateUpdated:!1,busy:!1,sourceFromUrlParam:null,showVertragsbeginnModal:!1,showCollectiveIdModal:!1,hasNameChanged:!1,phoneNumber:null}},validations:{contractStartDate:{KEY_REQUIRED:O["i"],ISO_DATE_ERROR:O["e"]},location:{KEY_REQUIRED:O["i"]},collectivePartnerId:{KEY_REQUIRED:Object(P["requiredIf"])((function(){return this.submitTried&&this.isCollective})),REGEX_ERROR:function(t){return Object(O["a"])(t)&&(this.isCollectivePartner(t)||!this.isCollective)}},people:{$each:{dateOfBirth:{KEY_REQUIRED:O["i"],ISO_DATE_ERROR:O["e"]},firstName:{MIN_ERROR:Object(P["minLength"])(2)},gender:{KEY_REQUIRED:O["i"]},personGroup:{KEY_REQUIRED:Object(P["requiredIf"])((function(){return this.submitTried&&this.isCollective&&this.collectivePersonGroups.length>0}))}}}},created:function(){window.dispatchEvent(new CustomEvent("sanitas-ovp-basket-close")),localStorage.removeItem("sanitas-dap");var t=this.queryParams;this.presetFormParameters(t);var e=this.collectiveContractNumber||this.selectedCollectiveContractNumber;e&&this.initalizeCollectiveContract(e),this.initalizePersons(t),Object(o["get"])(t,"skipPersonsScreen",!1)&&(this.busy=!0,setTimeout(this.submit,1e3))},mounted:function(){var t,e=this;Object(D["x"])("ovp",{ovpScreen:"persons"});var n,r,a,o,i,s="sanitasComAliasReferrer",c=sessionStorage.getItem(s),l="PriceWidget"===this.source,u=null===(t=document.querySelector('link[hreflang="x-default"]'))||void 0===t?void 0:t.href;l?n=u||(null===(r=window)||void 0===r?void 0:null===(a=r.location)||void 0===a?void 0:a.href):n=c||u||(null===(o=window)||void 0===o?void 0:null===(i=o.location)||void 0===i?void 0:i.href);Object(D["o"])("ovp","OvpScreenPersonsFunneled",{personsScreenSource:this.sourceFromUrlParam,entryElementAliasUrl:n,vepa:this.partnerId||"",bundleCode:this.bundleCode||""}),this.$watch((function(t){return[t.contractStartDate,t.isCollective].join()}),(function(t,n){var r=t.split(","),a=n.split(","),o="true"===r[1];if(!o)return e.collectivePartnerId=null,void e.resetCollectiveContract();var i=!1===e.$v.contractStartDate.$invalid;0!==e.collectivePartnersForDropdown.length&&r[0]===a[0]||!i||e.loadCollectiveConfig({contractStartDate:Object(y["e"])(r[0],y["c"])})}))},computed:k({},Object(i["c"])(["address","label","persons","hasPartner","partnerId","bundleCode","hasProducts","isCollectivePartner","getCollectivePartner","collectiveContractNumber","getCollectivePersonGroups","collectivePartnersForDropdown","selectedCollectiveContractNumber"]),{},Object(i["c"])({basketContractStartDate:"contractStartDate"}),{queryParams:function(){return Object(S["a"])(this.$route)},hasMessages:function(){return this.onlyBabyPersons||this.contractStartDateUpdated||this.hasNameChanged},collectivePersonGroups:function(){return this.getCollectivePersonGroups(this.collectivePartnerId)},showCollectiveForm:function(){return!this.hasPartner&&(this.isCollective||!Object(o["isEmpty"])(this.selectedCollectiveContractNumber))},hasLocation:function(){return!Object(o["isEmpty"])(this.location)},minContractStartDate:function(){return Object(s["a"])(Object(c["a"])(new Date,3),y["c"])},maxContractStartDate:function(){return Object(s["a"])(Object(l["a"])(new Date,18),y["c"])},collectiveToggleItems:function(){return[{value:!0,text:this.label("toggle_yes")},{value:!1,text:this.label("toggle_no")}]}}),methods:k({},Object(i["b"])(["updateContractInformation","updateSelectedCriteriaForPersons","loadCollectiveConfig","removeEntryData","resetCollectiveConfig","setAddress","setSelectedCollectiveContractNumber"]),{getLocation:function(t,e){var n=this;return new Promise((function(r,a){var o={query:e,type:t};n.$backend.locations.getLocations(o).then((function(t){r(t.data)})).catch((function(t){a(t)}))}))},presetFormParameters:function(t){if(this.contractStartDate=Object(y["e"])(this.basketContractStartDate,y["c"]),this.sourceFromUrlParam=Object(o["get"])(t,"source",this.source),this.location=this.address.zipCode?this.address:{},!this.hasLocation){var e=t.locationNumber,n=t.zipCode,r=t.zipCodeAddon;e&&n&&r&&this.presetAddress({locationNumber:e,zipCode:n,zipCodeAddon:r})}},presetAddress:function(){var t=N(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.setAddress(e);case 2:this.location=this.address;case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initalizeCollectiveContract:function(){var t=N(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",this.loadCollectiveConfig({contractStartDate:Object(y["e"])(this.contractStartDate,y["c"])}).then((function(){n.collectivePartnerId=e,n.isCollective=!0})));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initalizePersons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.birthdate,r=e.birthDate,a=e.firstName,i=e.gender;if(this.persons.length>0)this.persons.forEach((function(e){var n=Object(o["pick"])(e,["id","firstName","dateOfBirth","gender","order","personGroup"]);t.people.push(n)}));else{var s=I["a"].sessionId,c=n||r;if(c&&i){var l={id:s,firstName:a,dateOfBirth:Object(y["e"])(c,y["c"]),gender:i.toUpperCase()};this.addPerson(l)}else this.addPerson({id:s})}},isPersonsAddEnabled:function(){return this.people.length<I["a"].personsMaxQty},checkContractStartDate:function(){var t=Object(u["a"])(this.contractStartDate);if(t)if(Object(d["a"])(t)){var e=Object(u["a"])(Object(s["a"])(Object(c["a"])(new Date,3),y["c"]));if(Object(p["a"])(t,e))return this.contractStartDateUpdated=!0,this.contractStartDate=Object(y["e"])(e,y["c"]),!1}else if(Object(h["a"])(t)){var n=Object(u["a"])(Object(s["a"])(Object(l["a"])(new Date,18),y["c"]));if(Object(v["a"])(t,n))return this.contractStartDateUpdated=!0,this.contractStartDate=Object(y["e"])(n,y["c"]),!1}return!0},checkBaby:function(){var t=Object(_["d"])(this.people,new Date),e=t.onlyBaby,n=t.ageOfBaby;return!e||(this.onlyBabyPersons=!0,this.contractStartDate===n)||(this.contractStartDate=n,!1)},slugifyName:function(t,e,n){if(n){var r=Object(w["b"])(n),a=r!==n;a&&(this.$set(this.people[t],e,r),this.hasNameChanged=a)}},updatePeopleOrder:function(){Object(o["forEach"])(this.people,(function(t,e){t.order=e+1}))},slugifyPersons:function(){var t=this;return this.hasNameChanged=!1,Object(o["map"])(this.people,(function(e,n){t.slugifyName(n,"lastName",e.lastName),t.slugifyName(n,"firstName",e.firstName)})),this.hasNameChanged},updateState:function(){var t=this,e=0===this.persons.length,n={contractStartDate:Object(y["e"])(this.contractStartDate,y["c"]),location:this.location,persons:this.people};if(this.collectivePartnerId&&this.isCollective){var r=this.getCollectivePartner(this.collectivePartnerId);n.collectivePartner={collectiveContractNumber:r.contractNumber,collectiveChannel:r.channel,masterTreaty:r.masterTreaty}}Object(D["x"])("ovp",{sessionId:n.persons[0].id}).then((function(){if(e)return Object(D["v"])()})).then((function(){var e,r,a,o=t.location,i=o.primeRegion,s=o.zipCode,c=t.$router?Object(S["b"])(t.$router.currentRoute,!0):(null===(e=document.querySelector('link[hreflang="x-default"]'))||void 0===e?void 0:e.href)||(null===(r=window)||void 0===r?void 0:null===(a=r.location)||void 0===a?void 0:a.href),l={firstPerson:{gender:n.persons[0].gender,birthYear:n.persons[0].dateOfBirth.substring(0,4)},location:{plz:s,premiumRegion:i},page:{aliasUrl:c}};return n&&n.collectivePartner?l.collectivePartner=n.collectivePartner:l.collectivePartner={collectiveContractNumber:""},l.vepa=t.partnerId||"",l.bundleCode=t.bundleCode||"",Object(D["p"])(l)})),this.updateContractInformation(n).then((function(){t.updateSelectedCriteriaForPersons(t.people),t.$emit("save")})),window.setTimeout((function(){"Configurator"===t.source&&window.scrollTo(0,0),!e&&t.hasProducts&&window.dispatchEvent(new CustomEvent("sanitas-ovp-basket-open"))}),100)},submit:function(){this.busy=!0,this.submitTried=!0,this.$v.$touch(),this.$v.$invalid?this.busy=!1:this.checkBaby()||(this.busy=!1),this.checkContractStartDate()||(this.busy=!1),this.slugifyPersons()&&(this.busy=!1),this.busy&&(localStorage.removeItem(I["a"].ovpEntryStorageKey),this.updateState())},addPerson:function(t){var e=Object(j["a"])(this.people,t);this.persons.length>0&&this.persons[0].lastName&&(e.lastName=this.persons[0].lastName),this.people.push(e),this.collectivePartnerId&&this.setCollectivePersonGroupWhenOnlyOneGroup(this.collectivePartnerId)},deletePerson:function(t){this.people.splice(t,1),this.updatePeopleOrder(),0===this.people.length&&this.addPerson()},setCollectivePersonGroups:function(t){var e=this.getCollectivePersonGroups(t);this.people.map((function(t){return 1===e.length?t.personGroup=e[0].value:t.personGroup=null,t}))},setCollectivePersonGroupWhenOnlyOneGroup:function(t){var e=this.getCollectivePersonGroups(t);this.people.map((function(t){return 1===e.length&&(t.personGroup=e[0].value),t}))},resetCollectiveContract:function(){this.resetCollectiveConfig(),this.people.map((function(t){return t.personGroup=null,t}))}}),watch:{contractStartDate:function(){var t=this;this.$nextTick((function(){t.contractStartDate!==t.basketContractStartDate&&t.resetCollectiveContract()}))},collectivePartnerId:function(t){t!==this.collectiveContractNumber&&this.setCollectivePersonGroups(t),this.setSelectedCollectiveContractNumber(t)}}},G=$,z=(n("8bab8"),n("2877")),M=Object(z["a"])(G,r,a,!1,null,"4367fb40",null);e["a"]=M.exports},8953:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-container"},[t._t("default")],2)},a=[],o={name:"Container"},i=o,s=(n("deca"),n("2877")),c=Object(s["a"])(i,r,a,!1,null,"62822f70",null);e["a"]=c.exports},"8bab8":function(t,e,n){"use strict";var r=n("1959"),a=n.n(r);a.a},"9f91":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hasPartnerInfo()?n("sanitas-message",{staticClass:"partner-message"},[t.partnerInfo.logoPath?n("img",{staticClass:"partner-message__image",attrs:{alt:"partner-logo",src:t.partnerInfo.logoPath}}):t._e(),n("div",{domProps:{innerHTML:t._s(t.partnerInfo.text)}})]):t._e()},a=[],o=n("de76"),i=n("2f62");function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={name:"PartnerMessage",components:{SanitasMessage:o["g"]},computed:c({},Object(i["c"])(["partnerInfo"])),methods:{hasPartnerInfo:function(){return this.partnerInfo&&(this.partnerInfo.logoPath||this.partnerInfo.text)}}},d=u,p=(n("eb8d"),n("2877")),h=Object(p["a"])(d,r,a,!1,null,null,null);e["a"]=h.exports},deca:function(t,e,n){"use strict";var r=n("02b4"),a=n.n(r);a.a},eb8d:function(t,e,n){"use strict";var r=n("1838e"),a=n.n(r);a.a}}]);
//# sourceMappingURL=configurator-screen~entry-screen.js.map